{% extends 'MMSApp/base.html' %}
{% block content %}
{% load static %}

<br><br><br>

<div class="row">

  <div class="col s3 offset-s1">

    <div class="row">
      <div class="col s5">
          <a href="#!" id="leave_group_button_id" class="waves-effect waves-light btn" ><i class="material-icons left">exit_to_app</i>Leave</a>
      </div>
      <div class="col s4">
          <a href="#!" id="edit_group_button_id" class="waves-effect waves-light btn" style="display:none" ><i class="material-icons left">create</i>Edit</a>
      </div>
    </div>


    <div class="row" style="padding-right:0px;margin-right:0px">
      <div class="col s12">
        <ul class="tabs" style="background-color:#003d72;">
          <li class="tab col s12"><a class="active" >Members</a></li>
        </ul>
      </div>
    </div>

    <div class="fancyScroll" id="member_list_id" style="height:500px;overflow-y:auto;overflow-x:hidden;width:95%">
    </div>

  </div>

  <div class="col s6 offset-s1">

    <div class="row">
      <div class="col s2">
          <a href="/create/meeting" id="new_meeting_button_id" class="waves-effect waves-light btn" ><i class="material-icons left">add</i>New</a>
      </div>
    </div>

    <div class="row" style="padding-right:0px;margin-right:0px">
      <div class="col s12">
        <ul class="tabs" style="background-color:#003d72;">
          <li class="tab col s4"><a href="#ongoing_tab_id" >Onging Meetings</a></li>
          <li class="tab col s4"><a class="active" href="#upcoming_tab_id">Upcoming Meetings</a></li>
          <li class="tab col s4"><a href="#past_tab_id" >Past Meetings</a></li>
        </ul>
      </div>
    </div>

    <div class="fancyScroll" style="height:500px;overflow-y:auto;">

    </div>
  </div>

</div>

<script type="text/javascript">

  $(document).ready(function(){

    uuid = window.location.pathname;
    uuid = uuid.split("/")[2];

    $('#edit_group_button_id').attr("href","/edit/group/"+uuid);
    // $('#leave_group_button_id').attr("href","/edit/group/"+uuid); // API LEFT-------------------------------


    $.ajax({
        url: "/Get_Group_Details/",
        type: "POST",
        data: {
          'uuid' : uuid,
        },
        success: function(response) {
          console.log(response);
          if(response['status']==200){
            var temp = "";
            for(var i=0;i<response['admins'].length;i++){
              temp += '<div class="row valign-wrapper zero-margin">\
                <div class="col s2">\
                  <img src='+response['admins'][i]['dp']+' alt="Avatar" style="width:3em;height:3em;">\
                </div>\
                <div class="col s7" style="overflow-x:auto">\
                  <a href="/profile/'+response['admins'][i]['username']+'">'+response['admins'][i]['username']+'</a>\
                </div>\
                <div class="col s3">\
                  <span style="font-size:0.75em;">Admin</span>\
                </div>\
              </div><hr>';
            }
            for(var i=0;i<response['members'].length;i++){
              temp += '<div class="row valign-wrapper zero-margin">\
                <div class="col s2">\
                  <img src='+response['members'][i]['dp']+' alt="Avatar" style="width:3em;height:3em;">\
                </div>\
                <div class="col s10">\
                  <a href="/profile/'+response['members'][i]['username']+'">'+response['members'][i]['username']+'</a>\
                </div>\
              </div><hr>';
            }
            $("#member_list_id").append(temp);
            if(response['isAdmin'])
              jQuery('#edit_group_button_id').show()
          }
        },
      });

  });

</script>

{% endblock %}
